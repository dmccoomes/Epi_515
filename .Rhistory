summary(is.na(miss.wide))
miss.wide[!complete.cases(miss.wide),]
#dummy var for missing data
miss.wide$exp_miss <- ifelse(is.na(miss.wide$cd4cnt_ph1), 1, 0)
miss.wide$out_miss <- ifelse(is.na(miss.wide$oi4), 1, 0)
#dummy var for residence
miss.wide$res_0_5 <- ifelse(miss.wide$residence==0, 1, 0)
miss.wide$res_5_10 <- ifelse(miss.wide$residence==1, 1, 0)
miss.wide$res_10_up <- ifelse(miss.wide$residence==2, 1, 0)
#missing income
summary(miss.wide$income[miss.wide$exp_miss==1])
summary(miss.wide$income[miss.wide$exp_miss==0])
summary(miss.wide$income[miss.wide$out_miss==1])
summary(miss.wide$income[miss.wide$out_miss==0])
summary(miss.wide$income)
#missing study site
summary(miss.wide$site[miss.wide$exp_miss==1])
summary(miss.wide$site[miss.wide$exp_miss==0])
summary(miss.wide$site[miss.wide$out_miss==1])
summary(miss.wide$site[miss.wide$out_miss==0])
summary(miss.wide$site)
#missing gender
summary(miss.wide$sex[miss.wide$exp_miss==1])
summary(miss.wide$sex[miss.wide$exp_miss==0])
summary(miss.wide$sex[miss.wide$out_miss==1])
summary(miss.wide$sex[miss.wide$out_miss==0])
summary(miss.wide$sex)
#Age
summary(miss.wide$age[miss.wide$exp_miss==1])
summary(miss.wide$age[miss.wide$exp_miss==0])
summary(miss.wide$age[miss.wide$out_miss==1])
summary(miss.wide$age[miss.wide$out_miss==0])
summary(miss.wide$age)
#residence
describe.by(miss.wide, miss.wide$exp_miss)
describe.by(miss.wide, miss.wide$out_miss)
describe(miss.wide)
describe.by(miss.wide, miss.wide$oi4)
summary(miss.wide$age)
miss.wide$age_cat[miss.wide$age<=27] <- 1
miss.wide$age_cat[miss.wide$age>27 & miss.wide$age<=32] <- 2
miss.wide$age_cat[miss.wide$age>32 & miss.wide$age<=40] <- 3
miss.wide$age_cat[miss.wide$age>40] <- 4
summary(miss.wide$income)
miss.wide$income_cat[miss.wide$income<=18.75] <- 1
miss.wide$income_cat[miss.wide$income>18.75 & miss.wide$income<=26.74] <- 2
miss.wide$income_cat[miss.wide$income>26.74 & miss.wide$income<=30.50] <- 3
miss.wide$income_cat[miss.wide$income>30.50] <- 4
names(miss.wide)
var<-c(2:9, 11, 13:14, 21:22)
mice_vars <- miss.wide[,var]
names(mice_vars)
method <- c("logreg", "norm.nob", "logreg", "logreg", "norm.nob", "logreg", "logreg", "logreg", "norm.nob", "polyreg", "logreg", "polyreg", "polyreg")
mice <- mice(mice_vars[1:13], m=10, maxit=50, seed=135, method=method)
summary(mice)
imputed.model.mice <- glm.mids(formula=oi4~cd4cnt_ph1+art_base+septrin4+income_cat+site+age_cat, data=mice, family=binomial)
names(miss.wide)
#Second mice model - using categorical variables for income and age
names(miss.wide)
var<-c(2:9, 11, 13:14, 20:21)
mice_vars <- miss.wide[,var]
names(mice_vars)
method <- c("logreg", "norm.nob", "logreg", "logreg", "norm.nob", "logreg", "logreg", "logreg", "norm.nob", "polyreg", "logreg", "polyreg", "polyreg")
mice <- mice(mice_vars[1:13], m=10, maxit=50, seed=135, method=method)
imputed.model.mice <- glm.mids(formula=oi4~cd4cnt_ph1+art_base+septrin4+income_cat+site+age_cat, data=mice, family=binomial)
pool <- pool(imputed.model.mice)
summary(pool)
OR2 <- exp(-2.6950489)
OR_low2 <- exp(-2.6950489 - 1.96*1.499495)
OR_high2 <- exp(-2.6950489 + 1.96*1.499495)
OR2
OR_low2
OR_high2
model.5 <- glm(oi4~s1+s2+s3+s4+s5+septrin4, data=miss.wide, family=binomial)
lincom(model.5)
lincom(model.5, c("s1+s2+s3+s4+s5=0"))
model.0 <- glm(oi4~cd4cnt_ph1+septrin4, data=miss.wide, family=binomial)
anova(model.0, model.5, test="LRT")
lincom(model.5, c("s1=0"))
summary(miss.data$cd4cnt_ph1)
summary(miss.wide$cd4cnt_ph1)
miss.wide <- miss.wide %>%
mutate(s1=cd4cnt_ph1,
s2=(cd4cnt_ph1>2)*(cd4cnt_ph1 - 2),
s3=(cd4cnt_ph1>3)*(cd4cnt_ph1 - 3),
s4=(cd4cnt_ph1>4)*(cd4cnt_ph1 - 4),
s5=(cd4cnt_ph1>5)*(cd4cnt_ph1 - 5)
)
model.4 <- glm(oi4~s1+s2+s3+s4+s5+septrin4+art_base+site+age_cat, data=miss.wide, family=binomial)
lincom(model.4)
model.5 <- glm(oi4~s1+s2+s3+s4+s5+septrin4, data=miss.wide, family=binomial)
miss.wide <- miss.wide %>%
mutate(s1=cd4cnt_ph1,
s2=(cd4cnt_ph1>3)*(cd4cnt_ph1 - 3),
s3=(cd4cnt_ph1>4)*(cd4cnt_ph1 - 4),
s4=(cd4cnt_ph1>5)*(cd4cnt_ph1 - 5),
s5=(cd4cnt_ph1>6)*(cd4cnt_ph1 - 6)
)
model.5 <- glm(oi4~s1+s2+s3+s4+septrin4, data=miss.wide, family=binomial)
miss.wide <- miss.wide %>%
mutate(s1=cd4cnt_ph1,
s2=(cd4cnt_ph1>3)*(cd4cnt_ph1 - 3),
s3=(cd4cnt_ph1>5)*(cd4cnt_ph1 - 5),
s4=(cd4cnt_ph1>5)*(cd4cnt_ph1 - 5),
s5=(cd4cnt_ph1>6)*(cd4cnt_ph1 - 6)
)
model.5 <- glm(oi4~s1+s2+septrin4, data=miss.wide, family=binomial)
lincom(model.5)
lincom(model.5, c("s1=0"))
lincom(model.5, c("s1+s2=0"))
lincom(model.5, c("s1=0"))
model.0 <- glm(oi4~cd4cnt_ph1+septrin4, data=miss.wide, family=binomial)
anova(model.0, model.5, test="LRT")
lincom(model.5)
lincom(model.5, c("s1=0"))
lincom(model.5, c("s1+s2=0"))
OR <- exp(-2.390750681)
OR_low <- exp(-2.390750681 - 1.96*1.00605034)
OR_high <- exp(-2.390750681 + 1.96*1.00605034)
OR
OR_low
OR_high
miss.wide <- miss.wide %>%
mutate(s1=cd4cnt_ph1,
s2=(cd4cnt_ph1>3.5)*(cd4cnt_ph1 - 3.5),
s3=(cd4cnt_ph1>5)*(cd4cnt_ph1 - 5)
)
model.5 <- glm(oi4~s1+s2+s3+septrin4, data=miss.wide, family=binomial)
model.5 <- glm(oi4~s1+s2+s3, data=miss.wide, family=binomial)
model.5 <- glm(oi4~s1+s2+s3+septrin4, data=miss.wide, family=binomial) #model will not converge with spline variables
miss.wide$cd4_low <- ifelse(miss.wide$cd4cnt_ph1 <=350, 1, 0)
miss.wide$cd4_med <- ifelse(miss.wide$cd4cnt_ph1 <=500 & miss.wide$cd4cnt_ph1>350, 1, 0)
miss.wide$cd4_high <- ifelse(miss.wide$cd4cnt_ph1 >500, 1, 0)
model.6 <- glm(oi4~cd4_med+cd4_high+septrin4, data=miss.wide, family=binomial)
lincom(model.6)
model.6 <- glm(oi4~cd4_med+cd4_high+septrin4, data=miss.wide, family=binomial)
lincom(model.6)
summary(model.6)
summary(miss.wide$cd4cnt_ph1[miss.wide$oi4==1])
summary(miss.wide$cd4cnt_ph1[miss.wide$oi4==0])
hist(miss.wide$cd4cnt_ph1)
hist(miss.wide$cd4cnt_ph1, breaks=10)
hist(miss.wide$cd4cnt_ph1, breaks=20)
hist(miss.wide$cd4cnt_ph1, breaks=30)
hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1])
hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=20)
hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], breaks=20)
hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=20)
hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], breaks=20)
hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=30)
hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], breaks=30)
ggplot(miss.wide$cd4cnt_ph1, aes(length, fill=oi4))
library(ggplot2)
ggplot(miss.wide$cd4cnt_ph1, aes(length, fill=oi4))
ggplot(miss.wide, aes(length, fill=oi4))
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4))
ggplot(miss.wide, aes(cd4cnt_ph1))
ggplot(miss.wide, aes(cd4cnt_ph1) + geom_density(alpha=0.2))
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4) + geom_density(alpha=0.2))
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4) + geom_density(alpha=0.2)
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4)) + geom_density(alpha=0.2)
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4))
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4)) +
geom(histogram(alpha=0.5))
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4)) +
geom_histogram(alpha=0.5)
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4)) +
geom_histogram(alpha=0.5, aex(y = ..density..), position = 'identity')
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4)) +
geom_histogram(alpha=0.5, aes(y = ..density..), position = 'identity')
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4)) +
geom_histogram(alpha=0.5, aes(y = ..frequency..), position = 'identity')
ggplot(miss.wide, aes(cd4cnt_ph1, fill=oi4)) +
geom_histogram(alpha=0.5, aes(y = ..density..), position = 'identity')
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,10))
h1 <- hist(miss.wide$cd4cnt_ph1, breaks=30)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=30)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], breaks=30)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,10))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,10), add=T)
h1 <- hist(miss.wide$cd4cnt_ph1, breaks=30)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=20)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], breaks=20)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), add=T)
plot(h2, col=rgb(0,0,1,1/10), xlim=c(0,9))
plot(h3, col=rgb(1,0,0,1/10), xlim=c(0,9), add=T)
h1 <- hist(miss.wide$cd4cnt_ph1, breaks=30)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=20)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], breaks=20)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,10))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,10))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0, 10), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,10))
plot(h3, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0, 10), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,10))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0, 10), add=T)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=seq(0.1))
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], breaks=seq(1))
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=1)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=0.5)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], w=0.5)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,10))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0, 10), add=T)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=0.2)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], w=0.2)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,10))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0, 10), add=T)
h1 <- hist(miss.wide$cd4cnt_ph1, breaks=30)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=1)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], w=1)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,10))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0, 10), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,15))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,15), add=T)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=0.5)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], w=0.5)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,15))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,15), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20))
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", title="Histogram of CD4 Count by OI at Follow Up")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count"), title="Histogram of CD4 Count by OI at Follow Up"
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=0.5)
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], w=0.5)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
pool <- pool(imputed.model.mice)
summary(pool)
OR <- exp(-2.390750681)
OR_low <- exp(-2.390750681 - 1.96*1.00605034)
OR_high <- exp(-2.390750681 + 1.96*1.00605034)
OR
OR_low
OR_high
miss.wide$residence <- as.factor(miss.wide$residence)
miss.wide$site <- as.factor(miss.wide$site)
miss.wide$sex <- as.factor(miss.wide$sex)
miss.wide$art_base <- as.factor(miss.wide$art_base)
miss.wide$septrin1 <- as.factor(miss.wide$septrin1)
miss.wide$septrin4 <- as.factor(miss.wide$septrin4)
miss.wide$oi1 <- as.factor(miss.wide$oi1)
miss.wide$oi4 <- as.factor(miss.wide$oi4)
miss.wide$income_cat <- as.factor(miss.wide$income_cat)
miss.wide$age_cat <- as.factor(miss.wide$age_cat)
#first mice model
names(miss.wide)
var<-c(2:14)
mice_vars <- miss.wide[,var]
names(mice_vars)
method <- c("logreg", "norm.nob", "logreg", "logreg", "norm.nob", "logreg", "logreg", "logreg", "norm.nob", "norm.nob", "norm.nob", "polyreg", "logreg")
mice <- mice(mice_vars[1:13], m=10, maxit=50, seed=135, method=method)
imputed.model.mice <- glm.mids(formula=oi4~cd4cnt_ph1+art_base+septrin4+income+site+age, data=mice, family=binomial(link="logit"))
summary(imputed.model.mice)
pool <- pool(imputed.model.mice)
summary(pool)
OR <- exp(-2.390750681)
OR_low <- exp(-2.390750681 - 1.96*1.00605034)
OR_high <- exp(-2.390750681 + 1.96*1.00605034)
OR
OR_low
OR_high
model.2 <- glm(oi4~cd4cnt_ph1+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
lincom(model.2)
model.2 <- glm(oi4~cd4cnt_ph1+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
lincom(model.2)
plot(h2, col=rgb(0,0,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=0.5, xlim=c(0, 10))
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], w=0.5, xlim=c(0, 10))
plot(h2, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI")
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI", w=0.5)
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h2, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI", w=0.5)
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T, w=0.5)
library(mi)
plot(mice)
densityplot(mice)
h4 <- hist(miss.wide$cd4cnt_ph4[miss.wide$oi4==0], w=0.5, xlim=c(0, 10))
h5 <- hist(miss.wide$cd4cnt_ph4[miss.wide$oi4==0], w=0.5, xlim=c(0, 10))
plot(h4, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI", w=0.5)
plot(h5, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T, w=0.5)
h4 <- hist(miss.wide$cd4cnt_ph4[miss.wide$oi4==1], w=0.5, xlim=c(0, 10))
h5 <- hist(miss.wide$cd4cnt_ph4[miss.wide$oi4==0], w=0.5, xlim=c(0, 10))
plot(h4, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count by OI", w=0.5)
plot(h5, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T)
plot(h4, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,25), xlab="CD4 Count", main="Histogram of CD4 Count by OI", w=0.5)
plot(h5, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,25), add=T)
h1 <- hist(miss.wide$cd4cnt_ph1, breaks=30)
h2 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==1], w=0.5, xlim=c(0, 10))
h3 <- hist(miss.wide$cd4cnt_ph1[miss.wide$oi4==0], w=0.5, xlim=c(0, 10))
h4 <- hist(miss.wide$cd4cnt_ph4[miss.wide$oi4==1], w=0.5, xlim=c(0, 10))
h5 <- hist(miss.wide$cd4cnt_ph4[miss.wide$oi4==0], w=0.5, xlim=c(0, 10))
plot(h2, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count at baseline by OI", w=0.5)
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T, w=0.5)
plot(h4, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,25), xlab="CD4 Count", main="Histogram of CD4 Count at follow up by OI", w=0.5)
plot(h5, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,25), add=T)
plot(h2, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,20), xlab="CD4 Count", main="Histogram of CD4 Count at baseline by OI", w=0.5)
plot(h3, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,20), add=T, w=0.5)
plot(h4, col=rgb(0,1,1,1/4), xlim=c(0,9), ylim=c(0,25), xlab="CD4 Count", main="Histogram of CD4 Count at follow up by OI", w=0.5)
plot(h5, col=rgb(1,0,0,1/4), xlim=c(0,9), ylim=c(0,25), add=T)
miss.wide$cd4_change <- miss.wide$cd4cnt_ph1 - miss.wide$cd4cnt_ph4
summary(miss$wide$cd4_change)
summary(miss.wide$cd4_change)
hist(miss.wide$dc4_change)
hist(miss.wide$cd4_change)
hist(miss.wide$cd4_change, w=0.25)
hist(miss.wide$cd4_change, w=0.5)
hist(miss.wide$cd4_change, break=10)
hist(miss.wide$cd4_change, breaks=10)
model.2 <- glm(oi4~cd4cnt_ph1+septrin4+art_base+site:cd4cnt_ph1+age+income, data=miss.wide, family=binomial)
lincom(model.2)
model.2 <- glm(oi4~cd4cnt_ph1+septrin4+art_base+site:cd4cnt_ph1+age+income, data=miss.wide, family=binomial)
lincom(model.2)
model.2 <- glm(oi4~cd4cnt_ph1+septrin4+art_base+site:cd4cnt_ph1+age+income, data=miss.wide, family=binomial)
lincom(model.2)
summary(model.2)
model.2 <- glm(oi4~cd4cnt_ph1+septrin4+art_base+site:oi4+age+income, data=miss.wide, family=binomial)
lincom(model.2)
hist(miss.wide$cd4_change, breaks=10)
model.2 <- glm(oi4~cd4cnt_ph1+cd4_cnt_ph4+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
model.2 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
lincom(model.2)
miss.income <- glm(oi4~miss.income, data=miss.wide, family=binomial)
miss.wide$income_miss <- ifelse(is.na(miss.wide$income), 1, 0)
miss.income <- glm(oi4~income_miss, data=miss.wide, family=binomial)
summary(miss.income)
miss.income2 <- glm(cd4cnt_ph1~income_miss, data=miss.wide, family=binomial)
miss.income2 <- glm(cd4cnt_ph1~income_miss, data=miss.wide, family=identity)
miss.income2 <- glm(cd4cnt_ph1~income_miss, data=miss.wide, link=log)
miss.income2 <- glm(cd4cnt_ph1~income_miss, data=miss.wide, link="log")
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4, data=miss.wide, family=binomial)
summary(model.1)
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4, data=miss.wide, family=binomial)
summary(model.1)
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base, data=miss.wide, family=binomial)
summary(model.1)
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site, data=miss.wide, family=binomial)
summary(model.1)
lincom(model.1)
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site+age, data=miss.wide, family=binomial)
summary(model.1)
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
summary(model.1)
lincom(model.1)
library(UWbe536)
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
summary(model.1)
lincom(model.1)
lincom(model.1, c("cd4cnt_ph1=0"))
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
lincom(model.1)
miss.wide$residence <- as.factor(miss.wide$residence)
miss.wide$site <- as.factor(miss.wide$site)
miss.wide$sex <- as.factor(miss.wide$sex)
miss.wide$art_base <- as.factor(miss.wide$art_base)
miss.wide$septrin1 <- as.factor(miss.wide$septrin1)
miss.wide$septrin4 <- as.factor(miss.wide$septrin4)
miss.wide$oi1 <- as.factor(miss.wide$oi1)
miss.wide$oi4 <- as.factor(miss.wide$oi4)
miss.wide$income_cat <- as.factor(miss.wide$income_cat)
miss.wide$age_cat <- as.factor(miss.wide$age_cat)
#first mice model
names(miss.wide)
var<-c(2:14)
mice_vars <- miss.wide[,var]
names(mice_vars)
method <- c("logreg", "norm.nob", "logreg", "logreg", "norm.nob", "logreg", "logreg", "logreg", "norm.nob", "norm.nob", "norm.nob", "polyreg", "logreg")
mice <- mice(mice_vars[1:13], m=10, maxit=50, seed=135, method=method)
imputed.model.mice <- glm.mids(formula=oi4~cd4cnt_ph1+cd4cnt_ph4+art_base+septrin4+income+site+age, data=mice, family=binomial(link="logit"))
summary(imputed.model.mice)
pool <- pool(imputed.model.mice)
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(haven)
library(stats)
library(tidyr)
library(reshape2)
library(psych)
library(UWbe536)
library(mice)
library(dplyr)
#library(mi)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
link="https://github.com/dmccoomes/Epi_515/raw/master/epi528_missing_data_analysis_WIDE.dta"
miss.wide <- read_dta(url(link))
summary(is.na(miss.wide))
miss.wide[!complete.cases(miss.wide),]
#dummy var for missing data
miss.wide$exp_miss <- ifelse(is.na(miss.wide$cd4cnt_ph1), 1, 0)
miss.wide$out_miss <- ifelse(is.na(miss.wide$oi4), 1, 0)
#dummy var for residence
miss.wide$res_0_5 <- ifelse(miss.wide$residence==0, 1, 0)
miss.wide$res_5_10 <- ifelse(miss.wide$residence==1, 1, 0)
miss.wide$res_10_up <- ifelse(miss.wide$residence==2, 1, 0)
#missing income
summary(miss.wide$income[miss.wide$exp_miss==1])
summary(miss.wide$income[miss.wide$exp_miss==0])
summary(miss.wide$income[miss.wide$out_miss==1])
summary(miss.wide$income[miss.wide$out_miss==0])
summary(miss.wide$income)
miss.wide$income_miss <- ifelse(is.na(miss.wide$income), 1, 0)
#missing study site
summary(miss.wide$site[miss.wide$exp_miss==1])
summary(miss.wide$site[miss.wide$exp_miss==0])
summary(miss.wide$site[miss.wide$out_miss==1])
summary(miss.wide$site[miss.wide$out_miss==0])
summary(miss.wide$site)
#missing gender
summary(miss.wide$sex[miss.wide$exp_miss==1])
summary(miss.wide$sex[miss.wide$exp_miss==0])
summary(miss.wide$sex[miss.wide$out_miss==1])
summary(miss.wide$sex[miss.wide$out_miss==0])
summary(miss.wide$sex)
#Age
summary(miss.wide$age[miss.wide$exp_miss==1])
summary(miss.wide$age[miss.wide$exp_miss==0])
summary(miss.wide$age[miss.wide$out_miss==1])
summary(miss.wide$age[miss.wide$out_miss==0])
summary(miss.wide$age)
#residence
describe.by(miss.wide, miss.wide$exp_miss)
describe.by(miss.wide, miss.wide$out_miss)
describe(miss.wide)
describe.by(miss.wide, miss.wide$oi4)
summary(miss.wide$age)
miss.wide$age_cat[miss.wide$age<=27] <- 1
miss.wide$age_cat[miss.wide$age>27 & miss.wide$age<=32] <- 2
miss.wide$age_cat[miss.wide$age>32 & miss.wide$age<=40] <- 3
miss.wide$age_cat[miss.wide$age>40] <- 4
summary(miss.wide$income)
miss.wide$income_cat[miss.wide$income<=18.75] <- 1
miss.wide$income_cat[miss.wide$income>18.75 & miss.wide$income<=26.74] <- 2
miss.wide$income_cat[miss.wide$income>26.74 & miss.wide$income<=30.50] <- 3
miss.wide$income_cat[miss.wide$income>30.50] <- 4
miss.income <- glm(oi4~income_miss, data=miss.wide, family=binomial)
summary(miss.income)
miss.wide$cd4_exp1 <- miss.wide$cd4cnt_ph1*100
miss.wide$cd4cnt_ph1_2 <- miss.wide$cd4cnt_ph1^2
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
summary(model.1)
lincom(model.1)
lincom(model.1, c("cd4cnt_ph1=0"))
#creating factor variables
miss.wide$residence <- as.factor(miss.wide$residence)
miss.wide$site <- as.factor(miss.wide$site)
miss.wide$sex <- as.factor(miss.wide$sex)
miss.wide$art_base <- as.factor(miss.wide$art_base)
miss.wide$septrin1 <- as.factor(miss.wide$septrin1)
miss.wide$septrin4 <- as.factor(miss.wide$septrin4)
miss.wide$oi1 <- as.factor(miss.wide$oi1)
miss.wide$oi4 <- as.factor(miss.wide$oi4)
miss.wide$income_cat <- as.factor(miss.wide$income_cat)
miss.wide$age_cat <- as.factor(miss.wide$age_cat)
#first mice model
names(miss.wide)
var<-c(2:14)
mice_vars <- miss.wide[,var]
names(mice_vars)
method <- c("logreg", "norm.nob", "logreg", "logreg", "norm.nob", "logreg", "logreg", "logreg", "norm.nob", "norm.nob", "norm.nob", "polyreg", "logreg")
mice <- mice(mice_vars[1:13], m=10, maxit=50, seed=135, method=method)
summary(mice)
mice6<-complete(mice, 6)
View(mice6)
imputed.model.mice <- glm.mids(formula=oi4~cd4cnt_ph1+cd4cnt_ph4+art_base+septrin4+income+site+age, data=mice, family=binomial(link="logit"))
pool <- pool(imputed.model.mice)
lincom(pool)
summary(pool)
OR <- exp(-1.50591909)
OR_low <- exp(-1.50591909 - 1.96*1.1331857)
OR_high <- exp(-1.50591909 + 1.96*1.1331857)
OR
OR_low
OR_high
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site+age+income, data=miss.wide, family=binomial)
summary(model.1)
lincom(model.1)
lincom(model.1, c("cd4cnt_ph1=0"))
model.2 <- glm(oi4~cd4cnt, data=miss.wide, family=binomial)
model.2 <- glm(oi4~cd4cnt_ph1, data=miss.wide, family=binomial)
lincom(model.2)
imputed.model.mice_crude <- glm.mids(formula=oi4~cd4cnt_ph1, data=mice, family=binomial(link="logit"))
pool.crude <- pool(imputed.model.mice_crude)
summary(pool.crude)
OR <- exp(-1.336075)
OR_low <- exp(-1.336075 - 1.96*0.3066754)
OR_high <- exp(-1.336075 + 1.96*0.3066754)
OR
OR_low
OR_high
model.1 <- glm(oi4~cd4cnt_ph1+cd4cnt_ph4+septrin4+art_base+site:cd4cnt_ph1+age+income, data=miss.wide, family=binomial)
lincom(model.1)
lincom(model.1, c("cd4cnt_ph1=0"))
lincom(model.1, c("cd4cnt_ph1+site:cdrcnt_ph1=0"))
lincom(model.1, c("cd4cnt_ph1+site:cd4cnt_ph1=0"))
lincom(model.1)
lincom(model.1, c("cd4cnt_ph1+cd4cnt_ph1:site1=0"))
lincom(model.1, c("cd4cnt_ph1=0"))
